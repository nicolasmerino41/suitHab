---
title: "Jacobians"
author: "Nico"
date: "2025-10-21"
output:
  pdf_document:
    toc: false
    toc_depth: 5
  html_document:
    theme: flatly
    toc: true
    toc_depth: 5
    number_sections: true
    toc_float:
      collapsed: false
    highlight: tango
  word_document:
    toc: false
    toc_depth: '5'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Abundance Heterogeneity and Stability in Antisymmetric Systems

## 1. Introduction

We investigate how abundance heterogeneity affects the linear stability (resilience) of ecological communities whose interaction matrix is purely antisymmetric — i.e. trophic-like systems.

Starting from the generalized Lotka–Volterra (gLV) equations:

$$
\dot{u}_i = u_i \Big( K_i - u_i + \sum_{j} A_{ij} u_j \Big),
$$

we analyze the Jacobian at equilibrium, where \( K_i - u_i + (A u)_i = 0 \).

---

## 2. The Jacobian

The Jacobian \( J \) is defined as

$$
J_{ij} = \frac{\partial \dot{u}_i}{\partial u_j}.
$$

Differentiating term by term:

- For \( i \neq j \):
  $$
  J_{ij} = u_i A_{ij},
  $$

- For \( i = j \):
  $$
  J_{ii} = -u_i.
  $$

Hence, in compact form:

$$
J = \mathrm{diag}(u) (A - I).
$$

This means that every row of \(A - I\) is scaled by the corresponding equilibrium abundance \(u_i\).

---

## 3. The role of self-regulation

The term \( -I \) represents self-regulation. Setting its diagonal elements to -1 defines the *unit of interaction strength*: interspecific effects are measured **relative** to intraspecific self-limitation.  
If self-regulation constants differ (\( c_i \neq 1 \)), then \( I \) is replaced by \( C = \mathrm{diag}(c_i) \).

---

## 4. Equal vs. heterogeneous abundances

When all \(u_i\) are equal (\(u_i = u_0\)), the Jacobian simplifies to:

$$
J = u_0(A - I),
$$

and because \(A\) is antisymmetric (\(A^T = -A\)):

$$
\lambda_k(J) = u_0(i \omega_k - 1),
$$

where \(i \omega_k\) are the purely imaginary eigenvalues of \(A\).  
Therefore, all real parts equal \( -u_0 \):

$$
\text{Resilience} = -u_0.
$$

---

## 5. When abundances differ

Let \( D = \mathrm{diag}(u_1, u_2, \dots, u_S) \).  
Then:

$$
J = D(A - I) = DA - D.
$$

The non-commutativity between \(D\) and \(A\) is captured by their *commutator*:

$$
[D, A] = DA - AD,
$$

which is nonzero when abundances differ. Entrywise:

$$
([D, A])_{ij} = A_{ij}(u_i - u_j).
$$

This term vanishes if all \(u_i = u_j\), but otherwise introduces an extra symmetric contribution to the system.

---

## 6. Symmetric and antisymmetric parts of \(J\)

Decompose \(J\) as:

$$
J_s = \frac{J + J^T}{2} = -D + \frac{1}{2}[D,A],
$$
$$
J_a = \frac{J - J^T}{2} = \frac{1}{2}(DA + AD).
$$

- \(J_s\): determines **real parts** of eigenvalues (stability, damping).
- \(J_a\): determines **imaginary parts** (oscillations).

The term \(\tfrac{1}{2}[D,A]\) therefore adds or subtracts damping depending on how \(A\) and \(D\) misalign.

---

## 7. A 3×3 example

Let

$$
A =
\begin{pmatrix}
0 & a & b \\
-a & 0 & c \\
-b & -c & 0
\end{pmatrix}, \quad
D = \mathrm{diag}(u_1,u_2,u_3).
$$

Then

$$
J =
\begin{pmatrix}
-\,u_1 & a u_1 & b u_1 \\
-\,a u_2 & -\,u_2 & c u_2 \\
-\,b u_3 & -\,c u_3 & -\,u_3
\end{pmatrix}.
$$

The characteristic polynomial is:

$$
\lambda^3 + (u_1+u_2+u_3)\lambda^2
+ [u_1u_2(1-a^2) + u_1u_3(1-b^2) + u_2u_3(1-c^2)]\lambda
+ u_1u_2u_3[1-(a^2+b^2+c^2)] = 0.
$$

For equal abundances \(u_i = u_0\), the eigenvalues are shifted by \(-u_0\); for heterogeneous \(u_i\), real parts become more negative.

---

## 8. Perturbation around the equal-abundance case

Let \(u_i = \bar{u}(1 + \varepsilon h_i)\) with small heterogeneity (\(\varepsilon\) small, \(\sum_i h_i=0\)).

Then:

$$
J = \bar{u}(A - I) + \varepsilon \bar{u} H(A - I),
$$

where \(H = \mathrm{diag}(h_i)\).

Using first-order eigenvalue perturbation theory:

$$
\Re(\lambda_{\max}) \approx -\bar{u}
- \frac{\bar{u}}{2} \sum_{i<j} \frac{(A_{ij})^2}{1+(A_{ij})^2} (h_i - h_j)^2.
$$

Since \((h_i-h_j)^2\ge0\), the correction is always **negative**: heterogeneity enhances damping (resilience more negative).

## 9. Interpretation of the perturbation result

The perturbative expansion shows that the additional term

$$
- \frac{\bar{u}}{2} \sum_{i<j} \frac{(A_{ij})^2}{1+(A_{ij})^2}(h_i - h_j)^2
$$

is always **non-positive**, because it is a weighted sum of squared abundance differences.  
This means that, as soon as abundances deviate from equality, the dominant eigenvalue’s real part becomes more negative — the system experiences stronger damping.

In other words, **abundance heterogeneity stabilizes an otherwise neutrally rotating antisymmetric system**.

---

## 10. Geometric interpretation

In a perfectly antisymmetric community with equal abundances, the linearized dynamics correspond to pure rotations in phase space.  
Perturbing abundances (unequal \(u_i\)) scales each axis differently, skewing the rotational orbits.  
The result is a transformation of circular trajectories into spirals, which contract towards equilibrium — i.e. enhanced damping.

Thus, abundance heterogeneity transforms neutral rotations into **damped rotations**.

---

## 11. Spectral perspective

From a spectral viewpoint, \(J = D(A - I)\) can be written as

$$
J = D^{1/2}(D^{1/2} A D^{-1/2} - I) D^{1/2}.
$$

If \(D\) and \(A\) commute (equal abundances), the similarity transformation preserves the antisymmetry of \(A\), and eigenvalues lie on a vertical line with real part \(-\bar{u}\).

When \(D\) and \(A\) do not commute, the transformed operator \(B = D^{1/2} A D^{-1/2}\) gains a **symmetric component**, shifting the spectrum leftward.  
The spread of eigenvalues along the real axis increases with the variance of the \(u_i\), producing stronger overall damping.

---

## 12. Limits of the stabilizing effect

While small to moderate abundance heterogeneity increases stability, the effect is not unbounded.

1. **Perturbative regime:**  
   The analytical derivation assumes small heterogeneity. For large deviations, higher-order terms become significant and the linear relation no longer holds.

2. **Spectral saturation:**  
   As heterogeneity grows, coupling between species becomes dominated by a few abundant ones, while rare species effectively decouple.  
   The community’s effective dimensionality decreases, and the extra damping saturates.

3. **Numerical confirmation:**  
   Simulations show that for moderate CVs (= 0.3–1.0) resilience grows linearly with CV², while for CV >= 2.0, the effect plateaus or slightly reverses.

In summary, **heterogeneity stabilizes, but only up to a limit**.

---

## 13. Conclusions

We have provided a complete analytical framework for understanding how abundance heterogeneity impacts stability in antisymmetric ecological systems:

1. The Jacobian of a generalized Lotka–Volterra model is  
   \( J = \mathrm{diag}(u)(A - I) \).
2. For purely antisymmetric \(A\), equal abundances lead to purely imaginary eigenvalues shifted by \(-\bar{u}\), i.e. resilience \(=-\bar{u}\).
3. When abundances differ, \(D\) and \(A\) fail to commute, producing a commutator term \([D,A]\) that adds a symmetric contribution.
4. This new term increases the negative real parts of eigenvalues, enhancing damping and thus stability.
5. The approximate dependence of resilience on abundance heterogeneity is quadratic:
   $$
   \Re(\lambda_{\max}) \approx -\bar{u} - c \sum_{i<j} (A_{ij})^2 (u_i - u_j)^2.
   $$
6. Beyond moderate heterogeneity, this trend saturates as effective coupling weakens.

Hence, we can state formally:

**Abundance heterogeneity enhances stability in trophic (antisymmetric) systems by introducing a symmetric damping component through non-commutation of the Jacobian’s scaling and interaction operators.**

This result bridges random matrix theory and ecological dynamics, showing how variability in species abundances — even in fully antisymmetric networks — fundamentally alters the geometry of interactions and the shape of the stability spectrum.

---


